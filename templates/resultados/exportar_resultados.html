{% extends "base.html" %}

{% block title %}Exportar Resultados - SAC{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
    <h1 style="color: var(--dark); margin-bottom: 2rem;">Exportar Resultados</h1>

    <div class="card">
        <form method="POST">
            <div class="form-group">
                <label for="periodo">Período</label>
                <select id="periodo" name="periodo" required>
                    <option value="">-- Selecciona un período --</option>
                </select>
            </div>

            <div class="form-group">
                <label for="formato">Formato de Exportación</label>
                <select id="formato" name="formato" required>
                    <option value="xlsx">Excel (.xlsx)</option>
                    <option value="csv">CSV (.csv)</option>
                </select>
            </div>

            <div style="display: flex; gap: 1rem;">
                <button type="submit" class="btn btn-success">Exportar</button>
                <a href="{{ url_for('menu') }}" class="btn btn-secondary">Cancelar</a>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        cargarPeriodos();
    });

    function cargarPeriodos() {
        fetch('{{ url_for("api_get_periodos") }}')
            .then(response => response.json())
            .then(data => {
                const select = document.getElementById('periodo');
                data.forEach(periodo => {
                    const option = document.createElement('option');
                    option.value = periodo.nombre;
                    option.textContent = periodo.nombre;
                    select.appendChild(option);
                });
            });
    }
</script>
{% endblock %}
